let express,RpcClient,fs;_726‍.x([["default",()=>_726‍.o]]);_726‍.w("express",[["default",["express"],function(v){express=v}]]);_726‍.w("bitcoind-rpc",[["default",["RpcClient"],function(v){RpcClient=v}]]);_726‍.w("fs",[["default",["fs"],function(v){fs=v}]]);



let rpc;
fs.readFile('D:\\Kriptovalute\\clientConfig.txt', 'utf8' , (err, data) => {
  if (err) {
    _726‍.g.console.error(err);
    return;
  }
  rpc = new RpcClient(JSON.parse(data));
})

const bitcoinRouter = express.Router();

bitcoinRouter.get("/blockchain-info", function (req, res) {
    rpc.getBlockchainInfo(function (err, ret) {
        if (err) {
            _726‍.g.console.error(err);
            res.status(500).send({ message: err });
        } else {
            res.json(ret);
        }
    });
});

bitcoinRouter.get("/block-hash/:blockHeight", function (req, res) {
    rpc.getBlockHash(req.params.blockHeight, function (err, ret) {
        if (err) {
            _726‍.g.console.error(err);
            res.status(500).send({ message: err });
        } else {
            res.json(ret);
        }
    });
});

bitcoinRouter.get("/block/:blockHash", function (req, res) {
    rpc.getBlock(
        req.params.blockHash,
        function (err, ret) {
            if (err) {
                _726‍.g.console.error(err);
                res.status(500).send({ message: err });
            } else {
                res.json(ret);
            }
        }
    );
});

bitcoinRouter.get("/raw-transaction/:txId", function (req, res) {
    rpc.getRawTransaction(
        req.params.txId,
        function (err, tx) {
            if (err) {
                _726‍.g.console.error(err);
                res.status(500).send({ message: err });
            } else {
                rpc.decodeRawTransaction(tx.result, function (err, decodedTx) {
                    if (err) {
                        _726‍.g.console.error(err);
                        res.status(500).send({ message: err });
                    } else {
                        res.json(decodedTx);
                    }
                });
            }
        }
    );
});

bitcoinRouter.get("/mempool-info", function (req, res) {
    rpc.getMemPoolInfo(function (err, ret) {
        if (err) {
            _726‍.g.console.error(err);
            res.status(500).send({ message: err });
        } else {
            res.json(ret);
        }
    });
});

bitcoinRouter.get("/raw-mempool", function (req, res) {
    rpc.getRawMemPool(1, function (err, ret) {
        if (err) {
            _726‍.g.console.error(err);
            res.status(500).send({ message: err });
        } else {
            res.json(ret);
        }
    });
});

bitcoinRouter.get("/transactions", async function (req, res) {
    rpc.getRawMemPool(function (err, ret) {
        if (err) {
            _726‍.g.console.error(err);
            res.status(500).send({message: err});
        } else {
            res.status(200).json(ret);
        }
    });
});

_726‍.d(bitcoinRouter);
